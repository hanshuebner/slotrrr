set search_path to dcm, public;
<p>SET</p>
\set AUTOCOMMIT on
\set PROMPT1 'SQL:\n'
\set PROMPT2 'SQL (more)\n'
\set echo all
-- <h1>Anzahl gewonnene Rennen</h1><br>
select driver, count(*) from laps where lap = 10 group by driver order by count(*) desc;
<table border="1">
  <tr>
    <th align="center">driver</th>
    <th align="center">count</th>
  </tr>
  <tr valign="top">
    <td align="left">Patrick</td>
    <td align="right">10</td>
  </tr>
  <tr valign="top">
    <td align="left">Karsten</td>
    <td align="right">4</td>
  </tr>
  <tr valign="top">
    <td align="left">Torsten</td>
    <td align="right">4</td>
  </tr>
  <tr valign="top">
    <td align="left">Hans</td>
    <td align="right">3</td>
  </tr>
  <tr valign="top">
    <td align="left">Christoph</td>
    <td align="right">3</td>
  </tr>
</table>
<p>(5 rows)<br />
</p>
-- <h1>Anzahl gefahrene Runden</h1><br>
select driver, count(*) from laps group by driver order by count(*) desc;
<table border="1">
  <tr>
    <th align="center">driver</th>
    <th align="center">count</th>
  </tr>
  <tr valign="top">
    <td align="left">Patrick</td>
    <td align="right">148</td>
  </tr>
  <tr valign="top">
    <td align="left">Christoph</td>
    <td align="right">140</td>
  </tr>
  <tr valign="top">
    <td align="left">Hans</td>
    <td align="right">136</td>
  </tr>
  <tr valign="top">
    <td align="left">Karsten</td>
    <td align="right">131</td>
  </tr>
  <tr valign="top">
    <td align="left">Torsten</td>
    <td align="right">130</td>
  </tr>
  <tr valign="top">
    <td align="left">Detlev</td>
    <td align="right">94</td>
  </tr>
</table>
<p>(6 rows)<br />
</p>
-- <h1>Schnellste Runden je Track</h1><br>
select distinct on(track) driver, time from laps where time > 10 order by track, time asc;
<table border="1">
  <tr>
    <th align="center">driver</th>
    <th align="center">time</th>
  </tr>
  <tr valign="top">
    <td align="left">Patrick</td>
    <td align="right">10.9631</td>
  </tr>
  <tr valign="top">
    <td align="left">Patrick</td>
    <td align="right">10.3441</td>
  </tr>
  <tr valign="top">
    <td align="left">Patrick</td>
    <td align="right">10.7298</td>
  </tr>
  <tr valign="top">
    <td align="left">Patrick</td>
    <td align="right">10.2891</td>
  </tr>
</table>
<p>(4 rows)<br />
</p>
-- <h1>Schnellste Runde je Track f√ºr alle Fahrer</h1><br>
select distinct on(driver, track) driver, track, time from laps where time > 10 order by driver, track, time asc;
<table border="1">
  <tr>
    <th align="center">driver</th>
    <th align="center">track</th>
    <th align="center">time</th>
  </tr>
  <tr valign="top">
    <td align="left">Christoph</td>
    <td align="right">0</td>
    <td align="right">11.0038</td>
  </tr>
  <tr valign="top">
    <td align="left">Christoph</td>
    <td align="right">1</td>
    <td align="right">10.4198</td>
  </tr>
  <tr valign="top">
    <td align="left">Christoph</td>
    <td align="right">2</td>
    <td align="right">11.3668</td>
  </tr>
  <tr valign="top">
    <td align="left">Christoph</td>
    <td align="right">3</td>
    <td align="right">10.6292</td>
  </tr>
  <tr valign="top">
    <td align="left">Detlev</td>
    <td align="right">0</td>
    <td align="right">12.2291</td>
  </tr>
  <tr valign="top">
    <td align="left">Detlev</td>
    <td align="right">1</td>
    <td align="right">11.7304</td>
  </tr>
  <tr valign="top">
    <td align="left">Detlev</td>
    <td align="right">2</td>
    <td align="right">13.7188</td>
  </tr>
  <tr valign="top">
    <td align="left">Detlev</td>
    <td align="right">3</td>
    <td align="right">11.8639</td>
  </tr>
  <tr valign="top">
    <td align="left">Hans</td>
    <td align="right">0</td>
    <td align="right">11.2549</td>
  </tr>
  <tr valign="top">
    <td align="left">Hans</td>
    <td align="right">1</td>
    <td align="right">10.7379</td>
  </tr>
  <tr valign="top">
    <td align="left">Hans</td>
    <td align="right">2</td>
    <td align="right">10.9551</td>
  </tr>
  <tr valign="top">
    <td align="left">Hans</td>
    <td align="right">3</td>
    <td align="right">10.3614</td>
  </tr>
  <tr valign="top">
    <td align="left">Karsten</td>
    <td align="right">0</td>
    <td align="right">11.7789</td>
  </tr>
  <tr valign="top">
    <td align="left">Karsten</td>
    <td align="right">1</td>
    <td align="right">10.4814</td>
  </tr>
  <tr valign="top">
    <td align="left">Karsten</td>
    <td align="right">2</td>
    <td align="right">10.8379</td>
  </tr>
  <tr valign="top">
    <td align="left">Karsten</td>
    <td align="right">3</td>
    <td align="right">10.8431</td>
  </tr>
  <tr valign="top">
    <td align="left">Patrick</td>
    <td align="right">0</td>
    <td align="right">10.9631</td>
  </tr>
  <tr valign="top">
    <td align="left">Patrick</td>
    <td align="right">1</td>
    <td align="right">10.3441</td>
  </tr>
  <tr valign="top">
    <td align="left">Patrick</td>
    <td align="right">2</td>
    <td align="right">10.7298</td>
  </tr>
  <tr valign="top">
    <td align="left">Patrick</td>
    <td align="right">3</td>
    <td align="right">10.2891</td>
  </tr>
  <tr valign="top">
    <td align="left">Torsten</td>
    <td align="right">0</td>
    <td align="right">11.0723</td>
  </tr>
  <tr valign="top">
    <td align="left">Torsten</td>
    <td align="right">1</td>
    <td align="right">10.7068</td>
  </tr>
  <tr valign="top">
    <td align="left">Torsten</td>
    <td align="right">2</td>
    <td align="right">11.1522</td>
  </tr>
  <tr valign="top">
    <td align="left">Torsten</td>
    <td align="right">3</td>
    <td align="right">10.7326</td>
  </tr>
</table>
<p>(24 rows)<br />
</p>
-- <h1>Anzahl Siege pro Track</h1><br>
select track, count(*) from laps where lap = 10 group by track order by track;
<table border="1">
  <tr>
    <th align="center">track</th>
    <th align="center">count</th>
  </tr>
  <tr valign="top">
    <td align="right">0</td>
    <td align="right">2</td>
  </tr>
  <tr valign="top">
    <td align="right">1</td>
    <td align="right">7</td>
  </tr>
  <tr valign="top">
    <td align="right">2</td>
    <td align="right">3</td>
  </tr>
  <tr valign="top">
    <td align="right">3</td>
    <td align="right">12</td>
  </tr>
</table>
<p>(4 rows)<br />
</p>
